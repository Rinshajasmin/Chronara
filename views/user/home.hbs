
<head>
    <link rel="stylesheet" href="/css/user/home.css">
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>
     
     <header id="header" class="navbar">
        <div class="logo">chronara</div>
        <nav>
            <ul class="nav-links">
                <li><a href="/user/home">Home</a></li>
                <li><a href="/user/shop">Shop</a></li>
                <li><a href="/user/getAboutPage">About</a></li>

                {{!-- <li><a href="/user/cart/?id={{_id}}" >Cart</a></li> --}}
            </ul>
        </nav>
        
         {{#if username}}
         <div class="shopping-icon">
              <a href="/user/cart/?id={{_id}}" class="cart-icon">
              
                <i class="fas fa-shopping-cart"></i> <!-- Cart icon -->
              </a>
        <div class="dropdown">
          
          <a class="sign-in-link" href="#">  
            
                   <i class="fas fa-user-circle"></i> <!-- Profile icon -->


            {{username}}
          </a>
          <div class="dropdown-content">
            <a  href="/user/userProfile">Profile</a>
            <a href="/user/getUserOrders">My Orders</a>
            <a  href="/user/logout">Logout</a>
          </div>
        </div>
        </div>
        
        {{else}}
        <div class="auth-links">
            <a href="/user/login">Login</a> | <a href="/user/usersignup">Signup</a>
        </div>
       {{/if}}  
 
    </header> 


    <!-- Hero Section -->
    
    <section class="hero">
        <div class="hero-content">
            <h1>FIND TIMELESS ELEGANCE...</h1>
<p>Explore stylish, reliable, and high-quality watches at unbeatable prices. From timeless classics to the latest smartwatches, we’ve got it all. Don’t wait—find your perfect match and order now! </p>           <div class="search-bar">
                {{!-- <input type="text" placeholder="Search">
                <button>Search</button> --}}
            </div>
        </div>
        <div class="hero-image">
            <img src="/images/c72fdc0228d888b8b22ad50ad7b958b0.jpg" alt="Timeless Elegance">
        </div>
    </section>
    <!-- Categories Section -->
<section class="categories">
   {{#if successMessage}}
        <div class="alert alert-success">
            {{successMessage}}
        </div>
    {{/if}}
    <h2>Newest Collection Available</h2>
    <div class="category-list">
        <a href="/user/filter" class="category-item">
            <img src="/images/menwatch.png" alt="Men Watches">
            <p>Men</p>
        </a>
        <a href="/user/filter" class="category-item">
            <img src="/images/womenwatch.png" alt="Women Watches">
            <p>Women</p>
        </a>
        <a href="/user/shop" class="category-item">
            <img src="/images/casuals.png" alt="Casual Watches">
            <p>Casuals</p>
        </a>
        <a href="/user/shop" class="category-item">
            <img src="/images/smartwatch.png" alt="Smart Watches">
            <p>Smart Watches</p>
        </a>
    </div>
</section>


    
  

    <!-- Banner Section -->
    <div class="containerbanner">
    <section class="banner">
        <div class="banner-content">
            <h2>BESTSELLERS</h2>
            <p>From ₹500 to ₹10,000. Shop now...</p>
            <div class="banner-buttons">
            
                <button  class="btn-secondary">
                  <a href="/user/shop">SHOP NOW</a></button>
            </div>
        </div>
        <div class="banner-image">
            <img src="/images/8e6e3d853e0c6a47adbeab27317905dc-removebg-preview.png" alt="Models">
        </div>
    </section>
    </div>
      <div id="toast" class="toast"></div>

    <section class="watch-section">
  <div class="container">
    {{#each products}}
      <div class="watch-item">
        {{!-- <a href="/user/wishlist" class="wishlist-icon">
          <i class="fa-solid fa-heart"></i>
        </a> --}}
        <a href="javascript:void(0)" class="wishlist-icon" data-product-id="{{_id}}" onclick="toggleWishlist(this)">
    <i class="fa-solid fa-heart {{#if isWishlisted}}wishlist-active{{/if}}"></i>
</a>


        <!-- Product Image with Link -->
        <a href="/user/productDetails/?id={{_id}}">
          {{#if productImage.[0]}}
            <img src="{{productImage.[0]}}" alt="{{productName}}" />
          {{else}}
            <img src="/images/default-watch.jpg" alt="Default Image" />
          {{/if}}
        </a>

        <!-- Product Details -->
        <p>{{productName}}</p>
        <p>Price: ₹{{regularPrice}}</p>
        <p>
          {{#if quantity}}
            <span class="text-success">In Stock</span>
          {{else}}
            <span class="text-danger">Out of Stock</span>
          {{/if}}
        </p>
        {{#if quantity}}
          <div class="cart-link-container">
            {{!-- <form action="/user/addToCart" method="POST">
    <input type="hidden" id="productId" name="productId" value="{{_id}}">
    {{!-- <input type="hidden" id="userId" name="userId" value="{{user._id}}"> --}}
    {{!-- <button type="submit" class="btn btn-primary">Add to Cart</button>
</form>  --}}
<button class="add-to-cart-btn btn btn-primary" data-product-id="{{_id}}" onclick="addToCart('{{_id}}')">Add to Cart</button>



            {{!-- <a href="/user/cart/?id={{_id}}" class="link-add-to-cart">Add to Cart</a> --}}
          </div>
        {{/if}}
      </div>
    {{/each}}
  </div>
  <div id="toast" class="toast"></div>
  <div id="toast" class="toast">Item added to wishlist!</div>

 
</section>



    {{!-- <section class="watch-section">
  <div class="container">
    <div class="watch-item">
        <div class="wishlist-icon">
<i class="fa-regular fa-heart"></i>  </div>
        
              <img src="/images/2656WM01_1.webp" alt="TIMEX Watch">

      <span class="badge">New</span>
      <h3>TIMEX</h3>
      <p>Analog Watch - For Women</p>
      <button class="buy-btn">Buy</button>
    </div>

    <div class="watch-item">
        <div class="wishlist-icon">
<i class="fa-regular fa-heart"></i>  </div>
        
         <img src="/images/1805QM01_1.webp" alt="Van Heusen Watch">

      <span class="badge">New</span>
      <h3>VAN HEUSEN</h3>
      <p>Analog Watch - For Women</p>
      <button class="buy-btn">Buy</button>
    </div>

    <div class="watch-item">
        <div class="wishlist-icon">
<i class="fa-regular fa-heart"></i>  </div>
        
    <img src="/images/1806NL02_1.webp" alt="Van Heusen Watch">

      <span class="badge">New</span>
      <h3>VAN HEUSEN</h3>
      <p>Analog Watch - For Men</p>
      <button class="buy-btn">Buy</button>
    </div>

    <div class="watch-item">
        <div class="wishlist-icon">
<i class="fa-regular fa-heart"></i>  </div>
        
    <img src="/images/2644KM02_1.jpg" alt="TIMEX Watch">

      <span class="badge">New</span>
      <h3>TIMEX</h3>
      <p>Trending watch</p>
      <button class="buy-btn">Buy</button>
    </div>

    <div class="watch-item">
        <div class="wishlist-icon">
<i class="fa-regular fa-heart"></i>  </div>
        
              <img src="/images/90135SM01_1.webp" alt="ROLEX Watch">

      <span class="badge">New</span>
      <h3>ROLEX</h3>
      <p>Volt Analog  - For Men</p>
      <button class="buy-btn">Buy</button>
    </div>
  </div>
</section> --}}
  {{> userfooter}} <!-- Include the footer partial -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 
<script>
    function addToCart(productId) {
        // You can use AJAX here to send the productId to your backend
        fetch('/user/addToCart', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ productId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                Swal.fire({
                    title: 'Item Added!',
                    text: 'The item has been added to your cart.',
                    icon: 'success',
                    confirmButtonText: 'OK'
                });
                console.log(data.cartDetails);
            } else {
                Swal.fire({
                    title: 'Error!',
                    text: data.message || 'Something went wrong.',
                    icon: 'error',
                    confirmButtonText: 'OK'
                });
            }
        })
        .catch(error => {
            console.error('Error adding to cart:', error);
            Swal.fire({
                title: 'Error!',
                text: 'An unexpected error occurred.',
                icon: 'error',
                confirmButtonText: 'OK'
            });
        });
    }




</script>

<script>
  async function toggleWishlist(element) {
    const productId = element.getAttribute('data-product-id');

    try {
        const response = await fetch('/user/toggleWishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ productId }),
        });

        const data = await response.json();

        if (data.success) {
            const icon = element.querySelector('i');
            const toast = document.getElementById('toast');

            if (data.isWishlisted) {
                icon.classList.add('wishlist-active'); // Make heart red
                showToast('Item added to wishlist');

            } else {
                icon.classList.remove('wishlist-active'); // Revert to gray
                showToast('Item removed from wishlist')
            }
        } else {
            alert(data.message);
        }
    } catch (error) {
        console.error('Error toggling wishlist:', error);
        alert('An error occurred. Please try again.');
    }
}

function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');

    // Hide the toast after 3 seconds
    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

</script>


{{!-- <section class="watch-section">
  <div class="container">
    {{#each products}}
    <div class="watch-item">
      <div class="wishlist-icon">
        <i class="fa-regular fa-heart"></i>
      </div>
      <img src="{{this.productImage}}" alt="{{this.name}}">
      <span class="badge">{{#if this.isNew}}New{{/if}}</span>
      {{!-- <h3>{{this.brand}}</h3> --}}
      {{!-- <p>{{this.productDesc}}</p>
      <button class="buy-btn">Buy</button>
    </div>
    {{/each}}
  </div>
</section> 
{{!-- {{> userfooter}} <!-- Include the footer partial --> --}}
